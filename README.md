Hep_methylation_TF
===
Last update: 2021-11-09

Author: Takahiro Suzuki (takahiro.suzuki.aa@riken.jp)
<br><br>

## **Description**
## src/shell
---
### 1. beam2peaks_ATAC.sh

shell script for ChIPmentation peakcalling. 

First, from a bam file, remove the mitochondrial genome, duplicated, and "blacklist" reads.
Then, perform peakcalling with MACS2.

Usage:
```bash
 bash ./src/shell/bam2peaks_ATAC.sh -f [bam file] -r s -o [prefix] -p 1e-5
 ```
processed bam files and a directory of MACS2 result are generated.


### 2. bam2peaks_ChIP.sh
shell script for ChIPmentation peakcalling. 

First, from a bam file, remove the mitochondrial genome, duplicated, and "blacklist" reads.
Then, perform peakcalling with MACS2.

Usage:
```bash
 bash ./src/shell/bam2peaks_ChIP.sh -f [bam file] -r p -o [prefix] -p 1e-10
 ```
processed bam files and a directory of MACS2 result are generated.

<br><br>
For the preocessed bam file, bigwig files can be generated by following script.
```bash
bam2wig.py -t 1000000000 -i [bam file] -o [prefix] -u -s ./data/hg19.chrom.sizes
```
Dependency:

bam2wig.py (RseQC: http://rseqc.sourceforge.net/)

wigToBigWig (https://www.encodeproject.org/software/wigtobigwig/)



<br><br>

## src/R
---
### 1. Methyl850_HEP.r
- Preprocessing

   Normalization and M-value computation

- correlation matrix (Fg. 1C)
- DMR b2b plot (Fig. 1D)
- Functional analysis of DMRs (Fig. S2)
- Heatmap for methylation regulating TF (Fig. 2B, D)
- exprssion line plot (Fig. 2C and 2E; Fig. S3)

### 2. CAGE_HEP.r
- Expression Table for For  "Heatmap for methylation regulating TF (Fig. 2B, D)" in Methyl850_HEP.r
- Marker gene exprssion (Fig. S1A and S1C)

   Plots showing GOI expression pattern of GOIs



### 3. Methyl850_OE.r
- Preprocessing

    Normalization and M-value computation
	
- Scatter plot (Fig. 3B)
- Motf overrepresenation analysis (Fig. 3C)

### 4. Methyl850_DE.r
- preprocessing 

   Normalization and M-value computation
   
- DMR b2b plot (Fig. 4B)
- enrichment plot (Fig S5B and S5C)
- overlap of demethylated probes(upset plot)(Fig. 4C)
- methylation heatmap for uninheited demet probes (Fig. S5D)
- enrichment plot for uninherited demethylated regions (Fig. 4D)
- Enrichment heatmap(Fig. 4E and 5B)
- expression analysis for demet probes (Fig. 5A)
- Functional Annotation of DMRs (Fig. S6A)

### 5. CAGE_DE.r (Fig. S5A)

### 6. multi-omics.r(Fig. 6A)

### 7. ATAC_DE.r (Fig. S6C)

### 8. OE_DE_HEP_intersect.r (Fig. S5E)

<br><br>

## data/
---
- CAGE_HEP/gene_expMatrix.RData

R data containg a hepatocyte time-course expression matrix

- Methyl850_HEP/
    - motif analysis/
    - Hep_00_07
    - Hep_07_14
    - Hep_14_21
    - Hep_21_28

These directories contain results of motif overrepresentation analyses for demethylated regions (Demethy_mot_analysis_result.txt) and for methylated regions(Methyl_mot_analysis result.txt).

- Demethyl_motif_hatmap.RData and Methyl_motif_heatmap.RData

R data contating all objects in the Motf overrepresenation analysis

- Methyl850_DE/
    - bed_d1/*:   bed files of demethylated CpGs
    - bed_d500/*:   bed files of +- 250 bp region from demethylated CpGs
    - exp_table/*:   transcripts expression tables of demethylated regions (+- 250 bp region from demethylated CpGs) 
    
- genecode.v19.gene_only.gff3

The gencode human v19 data containing genes only

- human_permissive_enhancers_phase1_and_2.bed

The bed file of FANTOM5 permissive enhancers 

- hg19_blacklist.bed
The ENCODE blacklist

- hg19.chrom.sizes
Chromosome size for bigwig

- MethylationEPICv-1-0.B4.bed
Methylation array annotation file